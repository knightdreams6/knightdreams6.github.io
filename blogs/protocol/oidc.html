<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.67">
    <script>
      (function() {
        const userMode = localStorage.getItem('vuepress-reco-color-scheme') || 'auto';
        const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;

        if (userMode === 'dark' || (userMode === 'auto' && systemDarkMode)) {
          document.documentElement.classList.toggle('dark', true);
        }
      })();
    </script>
    <title>OIDC | Knightdreams'Blog</title><meta name="description" content="Blog">
    <link rel="modulepreload" href="/assets/app-d26df8f0.js"><link rel="modulepreload" href="/assets/oidc.html-2245f4bb.js"><link rel="modulepreload" href="/assets/oidc.html-46bd5bee.js"><link rel="prefetch" href="/assets/index.html-0a05feab.js" as="script"><link rel="prefetch" href="/assets/index.html-8c2edf06.js" as="script"><link rel="prefetch" href="/assets/index.html-4b3ba946.js" as="script"><link rel="prefetch" href="/assets/index.html-97546b91.js" as="script"><link rel="prefetch" href="/assets/index.html-a2578442.js" as="script"><link rel="prefetch" href="/assets/index.html-2b8b2faa.js" as="script"><link rel="prefetch" href="/assets/index.html-051f986d.js" as="script"><link rel="prefetch" href="/assets/index.html-ca578b98.js" as="script"><link rel="prefetch" href="/assets/index.html-0bb65ab7.js" as="script"><link rel="prefetch" href="/assets/index.html-4204965d.js" as="script"><link rel="prefetch" href="/assets/index.html-55a77791.js" as="script"><link rel="prefetch" href="/assets/index.html-2ceaa43c.js" as="script"><link rel="prefetch" href="/assets/index.html-5e53650f.js" as="script"><link rel="prefetch" href="/assets/index.html-1d285bfc.js" as="script"><link rel="prefetch" href="/assets/index.html-f03dc1d2.js" as="script"><link rel="prefetch" href="/assets/index.html-cfc01373.js" as="script"><link rel="prefetch" href="/assets/index.html-ff18e998.js" as="script"><link rel="prefetch" href="/assets/index.html-46a92963.js" as="script"><link rel="prefetch" href="/assets/index.html-10993ac1.js" as="script"><link rel="prefetch" href="/assets/index.html-1a64e81c.js" as="script"><link rel="prefetch" href="/assets/index.html-560c14b4.js" as="script"><link rel="prefetch" href="/assets/index.html-bd12e174.js" as="script"><link rel="prefetch" href="/assets/index.html-ed5792c1.js" as="script"><link rel="prefetch" href="/assets/index.html-9eb1513a.js" as="script"><link rel="prefetch" href="/assets/index.html-5f44320d.js" as="script"><link rel="prefetch" href="/assets/index.html-7053b800.js" as="script"><link rel="prefetch" href="/assets/index.html-743cadcd.js" as="script"><link rel="prefetch" href="/assets/index.html-138b6510.js" as="script"><link rel="prefetch" href="/assets/index.html-db045277.js" as="script"><link rel="prefetch" href="/assets/index.html-d4810458.js" as="script"><link rel="prefetch" href="/assets/index.html-93b00c29.js" as="script"><link rel="prefetch" href="/assets/index.html-9db08046.js" as="script"><link rel="prefetch" href="/assets/index.html-dbe1e240.js" as="script"><link rel="prefetch" href="/assets/index.html-f3f14f09.js" as="script"><link rel="prefetch" href="/assets/index.html-3dd4ee6c.js" as="script"><link rel="prefetch" href="/assets/index.html-8838a9fa.js" as="script"><link rel="prefetch" href="/assets/index.html-b35cc598.js" as="script"><link rel="prefetch" href="/assets/index.html-4e418448.js" as="script"><link rel="prefetch" href="/assets/index.html-8186470d.js" as="script"><link rel="prefetch" href="/assets/index.html-5c65c28e.js" as="script"><link rel="prefetch" href="/assets/index.html-b57fc99d.js" as="script"><link rel="prefetch" href="/assets/index.html-8c17c2e9.js" as="script"><link rel="prefetch" href="/assets/index.html-85c02b49.js" as="script"><link rel="prefetch" href="/assets/index.html-30840ab5.js" as="script"><link rel="prefetch" href="/assets/index.html-a1d115fd.js" as="script"><link rel="prefetch" href="/assets/index.html-6cf06f14.js" as="script"><link rel="prefetch" href="/assets/index.html-1a88d37b.js" as="script"><link rel="prefetch" href="/assets/index.html-c8e98ed0.js" as="script"><link rel="prefetch" href="/assets/index.html-800887e5.js" as="script"><link rel="prefetch" href="/assets/index.html-06f5ab5e.js" as="script"><link rel="prefetch" href="/assets/index.html-5d669565.js" as="script"><link rel="prefetch" href="/assets/index.html-cda0070c.js" as="script"><link rel="prefetch" href="/assets/index.html-fe378dda.js" as="script"><link rel="prefetch" href="/assets/index.html-a9be6a36.js" as="script"><link rel="prefetch" href="/assets/resume.html-cd45227c.js" as="script"><link rel="prefetch" href="/assets/RedisyuMySQLshuangxieyizhixingruhebaozheng.html-db0aed83.js" as="script"><link rel="prefetch" href="/assets/hulianwangjiagouweishimeyaozuoweifuwuhua.html-bcccc59d.js" as="script"><link rel="prefetch" href="/assets/hulianwangjiagou，ruhejinxingrongliangsheji.html-b10f863e.js" as="script"><link rel="prefetch" href="/assets/fenbushiyuweifuwuqubie.html-d8d1551d.js" as="script"><link rel="prefetch" href="/assets/miaoshaxitongjiagouyouhuasilu.html-57cb572b.js" as="script"><link rel="prefetch" href="/assets/fenbushishiwu.html-d0f2c1ff.js" as="script"><link rel="prefetch" href="/assets/yasuosuanfa.html-f5a6ed3a.js" as="script"><link rel="prefetch" href="/assets/fanxiangdaili.html-3e924e7c.js" as="script"><link rel="prefetch" href="/assets/shujukushiwu.html-25521a0c.js" as="script"><link rel="prefetch" href="/assets/lingyuqudongsheji.html-3213a4a7.js" as="script"><link rel="prefetch" href="/assets/winsock.html-ea8f6161.js" as="script"><link rel="prefetch" href="/assets/jiazaidll.html-5c8f13c2.js" as="script"><link rel="prefetch" href="/assets/duquchuankoushuju.html-58566673.js" as="script"><link rel="prefetch" href="/assets/dockerFile.html-59d13a04.js" as="script"><link rel="prefetch" href="/assets/dockerxiugaijingxiang.html-8277b1e8.js" as="script"><link rel="prefetch" href="/assets/dockeranzhuangRabbitMQ.html-ba2a02c6.js" as="script"><link rel="prefetch" href="/assets/dockeranzhuangelasticsearch.html-401b2e22.js" as="script"><link rel="prefetch" href="/assets/dockeranzhuangmysql.html-2d5a84a0.js" as="script"><link rel="prefetch" href="/assets/dockeranzhuangmysqlzhucongfuzhi.html-4a92a966.js" as="script"><link rel="prefetch" href="/assets/dockeranzhuangnginx.html-286cf435.js" as="script"><link rel="prefetch" href="/assets/video.html-3fc3cca2.js" as="script"><link rel="prefetch" href="/assets/CopyOnWriteArrayList.html-d4ddcd23.js" as="script"><link rel="prefetch" href="/assets/ForkJoinPool.html-5b11e59f.js" as="script"><link rel="prefetch" href="/assets/JDBC.html-acb3b61d.js" as="script"><link rel="prefetch" href="/assets/OOM.html-ed168c47.js" as="script"><link rel="prefetch" href="/assets/Stringleishejichengbukebiandeyuanyin.html-c5a720f7.js" as="script"><link rel="prefetch" href="/assets/javaSEyinandian.html-5f4ba33c.js" as="script"><link rel="prefetch" href="/assets/javaSEmianshiti（yi）.html-8b1d38e5.js" as="script"><link rel="prefetch" href="/assets/javaSEmianshiti（er）.html-1478ccbe.js" as="script"><link rel="prefetch" href="/assets/javanacunquyu.html-2b94d68c.js" as="script"><link rel="prefetch" href="/assets/javasuodefenlei.html-60f21a77.js" as="script"><link rel="prefetch" href="/assets/jvmmianshiti.html-ca1634c0.js" as="script"><link rel="prefetch" href="/assets/synchronizedsuo.html-fb1b183b.js" as="script"><link rel="prefetch" href="/assets/volatileguanjianzi.html-4d218377.js" as="script"><link rel="prefetch" href="/assets/ruhetongshifasongduogeyibuqingqiu.html-21106c01.js" as="script"><link rel="prefetch" href="/assets/duixiangchuangjiandeguocheng.html-7b190fc2.js" as="script"><link rel="prefetch" href="/assets/shuzu.html-e3f62bfb.js" as="script"><link rel="prefetch" href="/assets/zhengqueshiyongequalsfangfa.html-0f1a0200.js" as="script"><link rel="prefetch" href="/assets/xianchengchi.html-7cada7a8.js" as="script"><link rel="prefetch" href="/assets/Redisnacunmanliaozenmeban.html-d75c6194.js" as="script"><link rel="prefetch" href="/assets/rabbitmqduilieyujiaohuanji.html-03713d73.js" as="script"><link rel="prefetch" href="/assets/rediszhucongfuzhidekang.html-3d56e4ab.js" as="script"><link rel="prefetch" href="/assets/redisminglingchangjiandekang.html-45a98819.js" as="script"><link rel="prefetch" href="/assets/redisshujuchijiuhuadekang.html-02f7ba84.js" as="script"><link rel="prefetch" href="/assets/redisdenacuntaotaijizhi.html-799b934f.js" as="script"><link rel="prefetch" href="/assets/redisgaojitexing-weicaozuo.html-0353aa93.js" as="script"><link rel="prefetch" href="/assets/daodishimeshihougaiyongmq.html-a5d23822.js" as="script"><link rel="prefetch" href="/assets/mysqlzhucongfuzhi.html-7e98b3d7.js" as="script"><link rel="prefetch" href="/assets/mysqlshujuqianyi.html-80462936.js" as="script"><link rel="prefetch" href="/assets/mysqlsuoyinyuyouhua.html-9681f133.js" as="script"><link rel="prefetch" href="/assets/mysqlbianmayuzifuji.html-00ae7deb.js" as="script"><link rel="prefetch" href="/assets/mysqlbiaosuoyuxingsuo.html-247d3b52.js" as="script"><link rel="prefetch" href="/assets/mysqldiaoyou.html-334886cd.js" as="script"><link rel="prefetch" href="/assets/nginxshiyongchangjingyuxiangguangainian.html-9a204441.js" as="script"><link rel="prefetch" href="/assets/nginxchangyongpeizhi.html-8534ced1.js" as="script"><link rel="prefetch" href="/assets/nginxpeizhiyufa.html-7536a279.js" as="script"><link rel="prefetch" href="/assets/Single thread vs child process vs worker threads vs cluster in nodejs.html-e38f422e.js" as="script"><link rel="prefetch" href="/assets/DNS.html-c5db6d5e.js" as="script"><link rel="prefetch" href="/assets/MQTT.html-fc3aa2c1.js" as="script"><link rel="prefetch" href="/assets/oauth2.html-17e411bb.js" as="script"><link rel="prefetch" href="/assets/pipyuangenghuan.html-0c646a35.js" as="script"><link rel="prefetch" href="/assets/pythondajianMiniotuchuang.html-606d9203.js" as="script"><link rel="prefetch" href="/assets/stlmoxingjianmian.html-05bf46dc.js" as="script"><link rel="prefetch" href="/assets/ModelAttributezhujiedeshiyong.html-81b13b14.js" as="script"><link rel="prefetch" href="/assets/Mybatisyiduiduo，duoduiyichaxun.html-b142aae1.js" as="script"><link rel="prefetch" href="/assets/Mybatisyijihuancun.html-5bef2da3.js" as="script"><link rel="prefetch" href="/assets/MybatiszhixingyitiaoSqlyujudeliucheng.html-29a69a92.js" as="script"><link rel="prefetch" href="/assets/ResourceyuAutowiredzhujiedequbie.html-1c4c9cef.js" as="script"><link rel="prefetch" href="/assets/SpringSecurity.html-5114d732.js" as="script"><link rel="prefetch" href="/assets/Springboot-quartzdingshirenwu.html-fe0f6c9c.js" as="script"><link rel="prefetch" href="/assets/SpringzhongBeandeshengmingzhouqi.html-b85254ad.js" as="script"><link rel="prefetch" href="/assets/Springshengmingshishiwu.html-ed00aa2e.js" as="script"><link rel="prefetch" href="/assets/activitiliuchengyinqing.html-157b09f8.js" as="script"><link rel="prefetch" href="/assets/linuxyuwindowsqidongspringbootmingling.html-cee032bf.js" as="script"><link rel="prefetch" href="/assets/mavenmingling.html-a3105ce3.js" as="script"><link rel="prefetch" href="/assets/springbootfasongyoujian.html-3a7a4acd.js" as="script"><link rel="prefetch" href="/assets/ByteBuddy.html-fbf93da6.js" as="script"><link rel="prefetch" href="/assets/Reflections.html-a58965f5.js" as="script"><link rel="prefetch" href="/assets/seata.html-acbfd6ae.js" as="script"><link rel="prefetch" href="/assets/404.html-60b35caa.js" as="script"><link rel="prefetch" href="/assets/index.html-065b23f4.js" as="script"><link rel="prefetch" href="/assets/index.html-9be77919.js" as="script"><link rel="prefetch" href="/assets/index.html-7636aa0c.js" as="script"><link rel="prefetch" href="/assets/index.html-aff47732.js" as="script"><link rel="prefetch" href="/assets/index.html-7672e2d2.js" as="script"><link rel="prefetch" href="/assets/index.html-61b32778.js" as="script"><link rel="prefetch" href="/assets/index.html-7583be57.js" as="script"><link rel="prefetch" href="/assets/index.html-37ad117a.js" as="script"><link rel="prefetch" href="/assets/index.html-9e39c5bd.js" as="script"><link rel="prefetch" href="/assets/index.html-c768d6d5.js" as="script"><link rel="prefetch" href="/assets/index.html-44696345.js" as="script"><link rel="prefetch" href="/assets/index.html-acb7d46c.js" as="script"><link rel="prefetch" href="/assets/index.html-591967ba.js" as="script"><link rel="prefetch" href="/assets/index.html-3b4bd8d5.js" as="script"><link rel="prefetch" href="/assets/index.html-a2a71442.js" as="script"><link rel="prefetch" href="/assets/index.html-8a518f8a.js" as="script"><link rel="prefetch" href="/assets/index.html-d32310d2.js" as="script"><link rel="prefetch" href="/assets/index.html-0a744e88.js" as="script"><link rel="prefetch" href="/assets/index.html-fd80d6af.js" as="script"><link rel="prefetch" href="/assets/index.html-534cac3e.js" as="script"><link rel="prefetch" href="/assets/index.html-2bbe078c.js" as="script"><link rel="prefetch" href="/assets/index.html-eead4cb7.js" as="script"><link rel="prefetch" href="/assets/index.html-a7fc64e6.js" as="script"><link rel="prefetch" href="/assets/index.html-55ba34ec.js" as="script"><link rel="prefetch" href="/assets/index.html-99d763dd.js" as="script"><link rel="prefetch" href="/assets/index.html-d4c0a9a1.js" as="script"><link rel="prefetch" href="/assets/index.html-63ae1d36.js" as="script"><link rel="prefetch" href="/assets/index.html-6d278a26.js" as="script"><link rel="prefetch" href="/assets/index.html-ac750179.js" as="script"><link rel="prefetch" href="/assets/index.html-f6e81dc0.js" as="script"><link rel="prefetch" href="/assets/index.html-d3918ad6.js" as="script"><link rel="prefetch" href="/assets/index.html-0ee98e96.js" as="script"><link rel="prefetch" href="/assets/index.html-d6c0e8e1.js" as="script"><link rel="prefetch" href="/assets/index.html-8499324b.js" as="script"><link rel="prefetch" href="/assets/index.html-78857e6c.js" as="script"><link rel="prefetch" href="/assets/index.html-da14b63d.js" as="script"><link rel="prefetch" href="/assets/index.html-0b87915c.js" as="script"><link rel="prefetch" href="/assets/index.html-2cab2cbd.js" as="script"><link rel="prefetch" href="/assets/index.html-5d53fd85.js" as="script"><link rel="prefetch" href="/assets/index.html-bb69a846.js" as="script"><link rel="prefetch" href="/assets/index.html-fec83775.js" as="script"><link rel="prefetch" href="/assets/index.html-87382b25.js" as="script"><link rel="prefetch" href="/assets/index.html-0a5cfcb3.js" as="script"><link rel="prefetch" href="/assets/index.html-531295f8.js" as="script"><link rel="prefetch" href="/assets/index.html-fd4fdd7a.js" as="script"><link rel="prefetch" href="/assets/index.html-d056dd8c.js" as="script"><link rel="prefetch" href="/assets/index.html-8acdcc00.js" as="script"><link rel="prefetch" href="/assets/index.html-7267d75b.js" as="script"><link rel="prefetch" href="/assets/index.html-0306e8ba.js" as="script"><link rel="prefetch" href="/assets/index.html-23824d87.js" as="script"><link rel="prefetch" href="/assets/index.html-b737fe0e.js" as="script"><link rel="prefetch" href="/assets/index.html-b0d215c0.js" as="script"><link rel="prefetch" href="/assets/index.html-52c674b5.js" as="script"><link rel="prefetch" href="/assets/index.html-bdb273f3.js" as="script"><link rel="prefetch" href="/assets/resume.html-e05577f1.js" as="script"><link rel="prefetch" href="/assets/RedisyuMySQLshuangxieyizhixingruhebaozheng.html-e50194c6.js" as="script"><link rel="prefetch" href="/assets/hulianwangjiagouweishimeyaozuoweifuwuhua.html-c803aeb9.js" as="script"><link rel="prefetch" href="/assets/hulianwangjiagou，ruhejinxingrongliangsheji.html-5ed68286.js" as="script"><link rel="prefetch" href="/assets/fenbushiyuweifuwuqubie.html-1e54eab3.js" as="script"><link rel="prefetch" href="/assets/miaoshaxitongjiagouyouhuasilu.html-e62678b7.js" as="script"><link rel="prefetch" href="/assets/fenbushishiwu.html-d5ae5060.js" as="script"><link rel="prefetch" href="/assets/yasuosuanfa.html-86e3587b.js" as="script"><link rel="prefetch" href="/assets/fanxiangdaili.html-82e3c1d9.js" as="script"><link rel="prefetch" href="/assets/shujukushiwu.html-ba654f7d.js" as="script"><link rel="prefetch" href="/assets/lingyuqudongsheji.html-b321cf1e.js" as="script"><link rel="prefetch" href="/assets/winsock.html-366c5955.js" as="script"><link rel="prefetch" href="/assets/jiazaidll.html-b7c24077.js" as="script"><link rel="prefetch" href="/assets/duquchuankoushuju.html-37747aba.js" as="script"><link rel="prefetch" href="/assets/dockerFile.html-a96f98fd.js" as="script"><link rel="prefetch" href="/assets/dockerxiugaijingxiang.html-a002948e.js" as="script"><link rel="prefetch" href="/assets/dockeranzhuangRabbitMQ.html-eb36bbb9.js" as="script"><link rel="prefetch" href="/assets/dockeranzhuangelasticsearch.html-5e47afb7.js" as="script"><link rel="prefetch" href="/assets/dockeranzhuangmysql.html-8ecb6e27.js" as="script"><link rel="prefetch" href="/assets/dockeranzhuangmysqlzhucongfuzhi.html-a9887d5d.js" as="script"><link rel="prefetch" href="/assets/dockeranzhuangnginx.html-de99ff92.js" as="script"><link rel="prefetch" href="/assets/video.html-ec72c147.js" as="script"><link rel="prefetch" href="/assets/CopyOnWriteArrayList.html-b46c5e9c.js" as="script"><link rel="prefetch" href="/assets/ForkJoinPool.html-2bb475c5.js" as="script"><link rel="prefetch" href="/assets/JDBC.html-4494cb67.js" as="script"><link rel="prefetch" href="/assets/OOM.html-efe3ff34.js" as="script"><link rel="prefetch" href="/assets/Stringleishejichengbukebiandeyuanyin.html-b435ac07.js" as="script"><link rel="prefetch" href="/assets/javaSEyinandian.html-89a75f17.js" as="script"><link rel="prefetch" href="/assets/javaSEmianshiti（yi）.html-1e601543.js" as="script"><link rel="prefetch" href="/assets/javaSEmianshiti（er）.html-4e3d4a69.js" as="script"><link rel="prefetch" href="/assets/javanacunquyu.html-22121ee2.js" as="script"><link rel="prefetch" href="/assets/javasuodefenlei.html-1be7785f.js" as="script"><link rel="prefetch" href="/assets/jvmmianshiti.html-03cf7d5a.js" as="script"><link rel="prefetch" href="/assets/synchronizedsuo.html-8a1c3504.js" as="script"><link rel="prefetch" href="/assets/volatileguanjianzi.html-4d08f97f.js" as="script"><link rel="prefetch" href="/assets/ruhetongshifasongduogeyibuqingqiu.html-6d5a29d6.js" as="script"><link rel="prefetch" href="/assets/duixiangchuangjiandeguocheng.html-e4bc553f.js" as="script"><link rel="prefetch" href="/assets/shuzu.html-1d37dbef.js" as="script"><link rel="prefetch" href="/assets/zhengqueshiyongequalsfangfa.html-9d6c528f.js" as="script"><link rel="prefetch" href="/assets/xianchengchi.html-fc4cb2b3.js" as="script"><link rel="prefetch" href="/assets/Redisnacunmanliaozenmeban.html-088de07b.js" as="script"><link rel="prefetch" href="/assets/rabbitmqduilieyujiaohuanji.html-7052994b.js" as="script"><link rel="prefetch" href="/assets/rediszhucongfuzhidekang.html-1bc6c3d7.js" as="script"><link rel="prefetch" href="/assets/redisminglingchangjiandekang.html-a501ffaf.js" as="script"><link rel="prefetch" href="/assets/redisshujuchijiuhuadekang.html-306a1ba5.js" as="script"><link rel="prefetch" href="/assets/redisdenacuntaotaijizhi.html-9e1ec531.js" as="script"><link rel="prefetch" href="/assets/redisgaojitexing-weicaozuo.html-7422516f.js" as="script"><link rel="prefetch" href="/assets/daodishimeshihougaiyongmq.html-df4ab7db.js" as="script"><link rel="prefetch" href="/assets/mysqlzhucongfuzhi.html-1b376496.js" as="script"><link rel="prefetch" href="/assets/mysqlshujuqianyi.html-78fbaae5.js" as="script"><link rel="prefetch" href="/assets/mysqlsuoyinyuyouhua.html-cb269333.js" as="script"><link rel="prefetch" href="/assets/mysqlbianmayuzifuji.html-f876516f.js" as="script"><link rel="prefetch" href="/assets/mysqlbiaosuoyuxingsuo.html-aeb94b25.js" as="script"><link rel="prefetch" href="/assets/mysqldiaoyou.html-09fc9657.js" as="script"><link rel="prefetch" href="/assets/nginxshiyongchangjingyuxiangguangainian.html-08d833f7.js" as="script"><link rel="prefetch" href="/assets/nginxchangyongpeizhi.html-35817bbd.js" as="script"><link rel="prefetch" href="/assets/nginxpeizhiyufa.html-d14a4214.js" as="script"><link rel="prefetch" href="/assets/Single thread vs child process vs worker threads vs cluster in nodejs.html-117894e8.js" as="script"><link rel="prefetch" href="/assets/DNS.html-5018141a.js" as="script"><link rel="prefetch" href="/assets/MQTT.html-80fd9115.js" as="script"><link rel="prefetch" href="/assets/oauth2.html-c9af7381.js" as="script"><link rel="prefetch" href="/assets/pipyuangenghuan.html-44684aef.js" as="script"><link rel="prefetch" href="/assets/pythondajianMiniotuchuang.html-ffcf3b4e.js" as="script"><link rel="prefetch" href="/assets/stlmoxingjianmian.html-c3607b07.js" as="script"><link rel="prefetch" href="/assets/ModelAttributezhujiedeshiyong.html-1c398ee4.js" as="script"><link rel="prefetch" href="/assets/Mybatisyiduiduo，duoduiyichaxun.html-d5df0197.js" as="script"><link rel="prefetch" href="/assets/Mybatisyijihuancun.html-7f21b6fd.js" as="script"><link rel="prefetch" href="/assets/MybatiszhixingyitiaoSqlyujudeliucheng.html-d8ad61dc.js" as="script"><link rel="prefetch" href="/assets/ResourceyuAutowiredzhujiedequbie.html-94ad52c9.js" as="script"><link rel="prefetch" href="/assets/SpringSecurity.html-5e606c3c.js" as="script"><link rel="prefetch" href="/assets/Springboot-quartzdingshirenwu.html-25f6f227.js" as="script"><link rel="prefetch" href="/assets/SpringzhongBeandeshengmingzhouqi.html-3aba5a91.js" as="script"><link rel="prefetch" href="/assets/Springshengmingshishiwu.html-d7fc5f62.js" as="script"><link rel="prefetch" href="/assets/activitiliuchengyinqing.html-a386b11b.js" as="script"><link rel="prefetch" href="/assets/linuxyuwindowsqidongspringbootmingling.html-52547220.js" as="script"><link rel="prefetch" href="/assets/mavenmingling.html-e2f41a8d.js" as="script"><link rel="prefetch" href="/assets/springbootfasongyoujian.html-e29d665d.js" as="script"><link rel="prefetch" href="/assets/ByteBuddy.html-6fc3df72.js" as="script"><link rel="prefetch" href="/assets/Reflections.html-0408975a.js" as="script"><link rel="prefetch" href="/assets/seata.html-e696ebc9.js" as="script"><link rel="prefetch" href="/assets/404.html-5e50e838.js" as="script"><link rel="prefetch" href="/assets/reco-valine-a195b6e9.js" as="script"><link rel="prefetch" href="/assets/giscus-2a044aea-497f0bd4.js" as="script">
    <link rel="preload" href="/assets/style-837bfa2a.css" as="style"><link rel="stylesheet" href="/assets/style-837bfa2a.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><div class="common-wrapper series--no"><header class="navbar-container" style="top:0;"><div class="site-brand nav-item"><img class="logo" src="/logo.png" alt="Knightdreams&#39;Blog"><a href="/" class="site-name can-hide">Knightdreams&#39;Blog</a></div><div class="nav-item navbar-links-wrapper" style=""><div><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div><nav class="navbar-links"><!--[--><div class="navbar-links__item"><a href="/docs/resume.html" class="link" aria-label="简历"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->简历<!--]--></span></span><!--[--><!--]--></a></div><div class="navbar-links__item"><a href="/categories/concept/1/" class="link" aria-label="分类"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->分类<!--]--></span></span><!--[--><!--]--></a></div><div class="navbar-links__item"><a href="/tags/concept/1/" class="link" aria-label="标签"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->标签<!--]--></span></span><!--[--><!--]--></a></div><!--]--></nav><span class="xicon-container btn-toggle-dark-mode btn--dark-mode"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" style="width:20px;height:20px;font-size:20px;color:inherit;"><path d="M15 2h2v3h-2z" fill="currentColor"></path><path d="M27 15h3v2h-3z" fill="currentColor"></path><path d="M15 27h2v3h-2z" fill="currentColor"></path><path d="M2 15h3v2H2z" fill="currentColor"></path><path d="M5.45 6.884l1.414-1.415l2.121 2.122l-1.414 1.414z" fill="currentColor"></path><path d="M23 7.58l2.121-2.12l1.414 1.414l-2.121 2.121z" fill="currentColor"></path><path d="M23.002 24.416l1.415-1.414l2.12 2.122l-1.413 1.414z" fill="currentColor"></path><path d="M5.47 25.13L7.59 23L9 24.42l-2.12 2.12l-1.41-1.41z" fill="currentColor"></path><path d="M16 8a8 8 0 1 0 8 8a8 8 0 0 0-8-8zm0 14a6 6 0 0 1 0-12z" fill="currentColor"></path></svg></span><span class="xicon-container btn-toggle-menus"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" style="width:20px;height:20px;font-size:20px;color:inherit;"><circle cx="16" cy="8" r="2" fill="currentColor"></circle><circle cx="16" cy="16" r="2" fill="currentColor"></circle><circle cx="16" cy="24" r="2" fill="currentColor"></circle></svg></span></div></header><!----><div class="mobile-menus-container"><nav class="navbar-links mobile"><!--[--><div class="navbar-links__item"><a href="/docs/resume.html" class="link" aria-label="简历"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->简历<!--]--></span></span><!--[--><!--]--></a></div><div class="navbar-links__item"><a href="/categories/concept/1/" class="link" aria-label="分类"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->分类<!--]--></span></span><!--[--><!--]--></a></div><div class="navbar-links__item"><a href="/tags/concept/1/" class="link" aria-label="标签"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->标签<!--]--></span></span><!--[--><!--]--></a></div><!--]--></nav><div class="appearance"><span>Appearance</span><span class="xicon-container btn-toggle-dark-mode"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" style="width:20px;height:20px;font-size:20px;color:inherit;"><path d="M15 2h2v3h-2z" fill="currentColor"></path><path d="M27 15h3v2h-3z" fill="currentColor"></path><path d="M15 27h2v3h-2z" fill="currentColor"></path><path d="M2 15h3v2H2z" fill="currentColor"></path><path d="M5.45 6.884l1.414-1.415l2.121 2.122l-1.414 1.414z" fill="currentColor"></path><path d="M23 7.58l2.121-2.12l1.414 1.414l-2.121 2.121z" fill="currentColor"></path><path d="M23.002 24.416l1.415-1.414l2.12 2.122l-1.413 1.414z" fill="currentColor"></path><path d="M5.47 25.13L7.59 23L9 24.42l-2.12 2.12l-1.41-1.41z" fill="currentColor"></path><path d="M16 8a8 8 0 1 0 8 8a8 8 0 0 0-8-8zm0 14a6 6 0 0 1 0-12z" fill="currentColor"></path></svg></span></div></div><div class="series-mask"></div><aside class="series-container"><div class="site-brand"><img class="logo" src="/logo.png" alt="Knightdreams&#39;Blog"><a href="/" class="site-name can-hide">Knightdreams&#39;Blog</a></div><!--[--><!--]--></aside><!--[--><main class="page-container"><h1 class="page-title">OIDC</h1><div class="page-info"><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;"><path d="M16 4a5 5 0 1 1-5 5a5 5 0 0 1 5-5m0-2a7 7 0 1 0 7 7a7 7 0 0 0-7-7z" fill="currentColor"></path><path d="M26 30h-2v-5a5 5 0 0 0-5-5h-6a5 5 0 0 0-5 5v5H6v-5a7 7 0 0 1 7-7h6a7 7 0 0 1 7 7z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->knight<!--]--></span></span><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;"><path d="M26 4h-4V2h-2v2h-8V2h-2v2H6c-1.1 0-2 .9-2 2v20c0 1.1.9 2 2 2h20c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 22H6V12h20v14zm0-16H6V6h4v2h2V6h8v2h2V6h4v4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->2022-01-09 15:13:14<!--]--></span></span><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;"><path d="M11.17 6l3.42 3.41l.58.59H28v16H4V6h7.17m0-2H4a2 2 0 0 0-2 2v20a2 2 0 0 0 2 2h24a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2H16l-3.41-3.41A2 2 0 0 0 11.17 4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->protocol<!--]--></span></span><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;"><path d="M10 14a4 4 0 1 1 4-4a4.005 4.005 0 0 1-4 4zm0-6a2 2 0 1 0 1.998 2.004A2.002 2.002 0 0 0 10 8z" fill="currentColor"></path><path d="M16.644 29.415L2.586 15.354A2 2 0 0 1 2 13.941V4a2 2 0 0 1 2-2h9.941a2 2 0 0 1 1.414.586l14.06 14.058a2 2 0 0 1 0 2.828l-9.943 9.943a2 2 0 0 1-2.829 0zM4 4v9.942L18.058 28L28 18.058L13.942 4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->protocol<!--]--></span></span><!----></div><div class="theme-reco-default-content"><div><p>借鉴自：https://www.cnblogs.com/linianhui/p/openid-connect-core.html</p><h4 id="_1、什么是oidc" tabindex="-1"><a class="header-anchor" href="#_1、什么是oidc" aria-hidden="true">#</a> 1、什么是OIDC?</h4><p>官方网址：https://openid.net/connect/</p><p>OIDC 是 OpenID Connect 的简称，OIDC=(Identity, Authentication) + OAuth2.0。它在OAuth2上构建了一个身份层，是一个基于OAuth2协议的身份认证标准协议。OAuth2是一个授权协议，它无法提供完善的身份认证功能，OIDC使用OAuth2的授权服务器来为第三方客户端提供用户的身份认证，并把对应的身份认证信息传递给客户端，且可以适用于各种类型的客户端（比如服务端应用，移动APP，JS应用），且完全兼容OAuth2，也就是说你搭建了一个OIDC的服务后，也可以当作一个OAuth2的服务来用。</p><h4 id="_2、oidc-协议族" tabindex="-1"><a class="header-anchor" href="#_2、oidc-协议族" aria-hidden="true">#</a> 2、OIDC 协议族</h4><p>OIDC 本身是有多个规范构成，其中包含一个核心的规范，多个可选的规范来扩展支持</p><ol><li><a href="http://openid.net/specs/openid-connect-core-1_0.html" target="_blank" rel="noopener noreferrer">Core<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>：必选。定义OIDC的核心功能，在OAuth 2.0之上构建身份认证，以及如何使用Claims来传递用户的信息。</li><li><a href="http://openid.net/specs/openid-connect-discovery-1_0.html" target="_blank" rel="noopener noreferrer">Discovery<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>：可选。发现服务，使客户端可以动态的获取OIDC服务相关的元数据描述信息（比如支持那些规范，接口地址是什么等等）。</li><li><a href="http://openid.net/specs/openid-connect-registration-1_0.html" target="_blank" rel="noopener noreferrer">Dynamic Registration<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> ：可选。动态注册服务，使客户端可以动态的注册到OIDC的OP（这个缩写后面会解释）。</li><li><a href="http://openid.net/specs/oauth-v2-multiple-response-types-1_0.html" target="_blank" rel="noopener noreferrer">OAuth 2.0 Multiple Response Types<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> ：可选。针对OAuth2的扩展，提供几个新的response_type。</li><li><a href="http://openid.net/specs/oauth-v2-form-post-response-mode-1_0.html" target="_blank" rel="noopener noreferrer">OAuth 2.0 Form Post Response Mode<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>：可选。针对OAuth2的扩展，OAuth2回传信息给客户端是通过URL的querystring和fragment这两种方式，这个扩展标准提供了一基于form表单的形式把数据post给客户端的机制。</li><li><a href="http://openid.net/specs/openid-connect-session-1_0.html" target="_blank" rel="noopener noreferrer">Session Management<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> ：可选。Session管理，用于规范OIDC服务如何管理Session信息。</li><li><a href="http://openid.net/specs/openid-connect-frontchannel-1_0.html" target="_blank" rel="noopener noreferrer">Front-Channel Logout<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>：可选。基于前端的注销机制，使得RP（这个缩写后面会解释）可以不使用OP的iframe来退出。</li><li><a href="http://openid.net/specs/openid-connect-backchannel-1_0.html" target="_blank" rel="noopener noreferrer">Back-Channel Logout<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>：可选。基于后端的注销机制，定义了RP和OP直接如何通信来完成注销。</li></ol><h4 id="_3、oidc-核心概念" tabindex="-1"><a class="header-anchor" href="#_3、oidc-核心概念" aria-hidden="true">#</a> 3、OIDC 核心概念</h4><p>OAuth2 提供了 Access Token 来解决授权第三方客户端访问受保护资源的问题；OIDC 在这个基础上提供了 ID Token来解决第三方客户端标识用户身份认证的问题。OIDC的核心在于在OAuth2的授权流程中，一并提供用户的身份认证信息（ID Token）给到第三方客户端，ID Token使用JWT格式来包装，得益于JWT（<a href="http://www.cnblogs.com/linianhui/p/oauth2-extensions-protocol-and-json-web-token.html#auto_id_6" target="_blank" rel="noopener noreferrer">JSON Web Token<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>）的自包含性，紧凑性以及防篡改机制，使得ID Token可以安全的传递给第三方客户端程序并且容易被验证。此外还提供了UserInfo的接口，用户获取用户的更完整的信息。</p><h5 id="_3-1-oidc-主要术语" tabindex="-1"><a class="header-anchor" href="#_3-1-oidc-主要术语" aria-hidden="true">#</a> 3.1 OIDC 主要术语</h5><p>主要的术语以及概念介绍（完整术语参见http://openid.net/specs/openid-connect-core-1_0.html#Terminology）</p><ol><li>EU（End User）：一个人类用户</li><li>RP（Relying Party）：用来代指OAuth2中的受信任的客户端，身份认证和授权信息的消费方</li><li>OP（OpenID Provider）：有能力提供EU认证的服务（比如OAuth2中的授权服务），用来为RP提供EU的身份认证信息</li><li>ID Token：JWT格式的数据，包含EU身份认证的信息</li><li>UserInfo Endpoint：用户信息接口（受OAuth2保护），当RP使用Access Token访问时，返回授权用户信息，此接口必须使用HTTPS</li></ol><h5 id="_3-2-oidc-工作流程" tabindex="-1"><a class="header-anchor" href="#_3-2-oidc-工作流程" aria-hidden="true">#</a> 3.2 OIDC 工作流程</h5><p>从抽象的角度来看，OIDC的流程由以下5个步骤构成</p><ol><li>RP发送一个认证请求给OP</li><li>OP对EU进行身份认证，然后提供授权</li><li>OP把ID Token和AccessToken（需要的话）返回给RP</li><li>RP使用AccessToken发送一个请求UserInfo Endpoint</li><li>UserInfo Endpoint返回EU的Claims</li></ol><h5 id="_3-3-id-token" tabindex="-1"><a class="header-anchor" href="#_3-3-id-token" aria-hidden="true">#</a> 3.3 ID Token</h5><p><strong>OIDC对OAuth2最主要的扩展就是提供了ID Token。</strong> ID Token是一个安全令牌，是一个授权服务器提供的包含 <strong>用户信息（由一组Cliams构成以及其它辅助的Cliams）</strong> 的JWT格式的数据结构。ID Token的主要构成部分如下（使用OAuth2流程的OIDC）</p><ol><li>【必须】iss=Issuer Identifier。提供给认证信息者的唯一标识，一般是一个https的url（不包含querystring和fragment部分）</li><li>【必须】sub=Subject Identity。iss提供的EU的标识，在iss范围内唯一。它会被RP用来标识唯一的用户。最长为255个ASCII个字符</li><li>【必须】aud=Audience(s)。标识ID Token的受众。必须包含OAuth2的client_id。</li><li>【必须】exp=Expiration time。过期时间，超过此时间的ID Token会作废不再被验证通过。</li><li>【必须】iat=Issued At Time。JWT的构建的时间</li><li>auth_time=AuthencationTime：EU完成认证的时间。如果RP发送的认证请求携带max_age的参数，则此Claim是必须的</li><li>【可选】acr = Authentication Context Class Reference。表示一个认证上下文引用值，可以用来标识认证上下文类。</li><li>【可选】amr = Authentication Methods References。表示一组认证方法。</li><li>【可选】azp = Authorized party。结合aud使用。只有在被认证的一方和受众（aud）不一致时才使用此值，一般情况下很少使用。</li></ol><p>ID Token通常情况下还会包含其他的Claims（毕竟上述claim中只有sub是和EU相关的，这在一般情况下是不够的，必须还需要EU的用户名，头像等其他的资料，OIDC提供了一组公共的cliams，请移步这里http://openid.net/specs/openid-connect-core-1_0.html#StandardClaims）。另外ID Token必须使用JWS进行签名和JWE加密，从而提供认证的完整性、不可否认性以及可选的保密性。一个ID Token的例子如下：</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>  <span class="token punctuation">{</span>
    <span class="token property">&quot;iss&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://server.example.com&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;sub&quot;</span><span class="token operator">:</span> <span class="token string">&quot;24400320&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;aud&quot;</span><span class="token operator">:</span> <span class="token string">&quot;s6BhdRkqt3&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;nonce&quot;</span><span class="token operator">:</span> <span class="token string">&quot;n-0S6_WzA2Mj&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;exp&quot;</span><span class="token operator">:</span> <span class="token number">1311281970</span><span class="token punctuation">,</span>
    <span class="token property">&quot;iat&quot;</span><span class="token operator">:</span> <span class="token number">1311280970</span><span class="token punctuation">,</span>
    <span class="token property">&quot;auth_time&quot;</span><span class="token operator">:</span> <span class="token number">1311280969</span><span class="token punctuation">,</span>
    <span class="token property">&quot;acr&quot;</span><span class="token operator">:</span> <span class="token string">&quot;urn:mace:incommon:iap:silver&quot;</span>
   <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_3-4-认证" tabindex="-1"><a class="header-anchor" href="#_3-4-认证" aria-hidden="true">#</a> 3.4 认证</h5><p>OIDC的认证流程主要是由OAuth2的几种授权流程延伸而来的，有以下三种：</p><ol><li>Authorization Code Flow：使用Oauth2的授权码来换取Id Token和Access Token。</li><li>Implicit Flow：使用OAuth2的Implicit流程获取Id Token和Access Token。</li><li>Hybrid Flow：混合Authorization Code Flow+Implici Flow。</li></ol><h6 id="_3-4-1-基于authorization-code的认证请求" tabindex="-1"><a class="header-anchor" href="#_3-4-1-基于authorization-code的认证请求" aria-hidden="true">#</a> 3.4.1 基于Authorization Code的认证请求</h6><p>这种方式使用OAuth2的Authorization Code的方式来完成用户身份认证，所有的Token都是通过Token EndPoint（OAuth2中定义：https://tools.ietf.org/html/rfc6749#section-3.2）来发放的。构建一个OIDC的Authentication Request需要提供如下的参数：</p><ol><li>scope：必须。OIDC的请求必须包含值为“openId”的scope参数</li><li>response_type：必选。同OAuth2。</li><li>client_id：必选。同OAuth2。</li><li>redirect_uri：必选。同OAuth2。</li><li>state：推荐。同OAuth2。防止CSRF, XSRF。</li></ol><p>以上这5个参数是和OAuth2相同的。除此之外，还定义了如下的参数：</p><ol><li>response_mode：可选。OIDC新定义的参数（<a href="http://openid.net/specs/oauth-v2-form-post-response-mode-1_0.html" target="_blank" rel="noopener noreferrer">OAuth 2.0 Form Post Response Mode<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>），用来指定Authorization Endpoint以何种方式返回数据。</li><li>nonce：可选。ID Token中的出现的nonce就是来源于此。</li><li>display ： 可选。指示授权服务器呈现怎样的界面给EU。有效值有（page，popup，touch，wap），其中默认是page。page=普通的页面，popup=弹出框，touch=支持触控的页面，wap=移动端页面。</li><li>prompt：可选。这个参数允许传递多个值，使用空格分隔。用来指示授权服务器是否引导EU重新认证和同意授权（consent，就是EU完成身份认证后的确认同意授权的页面）。有效值有（none，login，consent，select_account）。none=不实现现任何认证和确认同意授权的页面，如果没有认证授权过，则返回错误login_required或interaction_required。login=重新引导EU进行身份认证，即使已经登录。consent=重新引导EU确认同意授权。select_account=假如EU在授权服务器有多个账号的话，允许EU选择一个账号进行认证。</li><li>max_age：可选。代表EU认证信息的有效时间，对应ID Token中auth_time的claim。比如设定是20分钟，则超过了时间，则需要引导EU重新认证。</li><li>ui_locales：可选。用户界面的本地化语言设置项。</li><li>id_token_hint：可选。之前发放的ID Token，如果ID Token经过验证且是有效的，则需要返回一个正常的响应；如果有误，则返回对应的错误提示。</li><li>login_hint：可选。向授权服务器提示登录标识符，EU可能会使用它登录(如果需要的话)。比如指定使用用户使用blackheart账号登录，当然EU也可以使用其他账号登录，这只是类似html中input元素的placeholder。</li><li>acr_values：可选。Authentication Context Class Reference values，对应ID Token中的acr的Claim。此参数允许多个值出现，使用空格分割。</li></ol><p>以上是基于Authorization Code方式的OIDC的认证请求所需的参数。在OIDC的其他认证流程中也会有其他的参数或不同的参数值（稍有差异）。一个简单的示例如下：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>GET /authorize?
    response_type=code
    &amp;scope=openid%20profile%20email
    &amp;client_id=s6BhdRkqt3
    &amp;state=af0ifjsldkj
    &amp;redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb HTTP/1.1
  Host: server.example.com
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>也可以是一个基于302的重定向方式。</p><h6 id="_3-4-2-基于-authorization-code的认证请求的响应" tabindex="-1"><a class="header-anchor" href="#_3-4-2-基于-authorization-code的认证请求的响应" aria-hidden="true">#</a> 3.4.2 基于 Authorization Code的认证请求的响应</h6><p>在授权服务器接收到认证请求之后，需要对请求参数做严格的验证，具体的规则参见http://openid.net/specs/openid-connect-core-1_0.html#AuthRequestValidation，验证通过后引导EU进行身份认证并且同意授权。在这一切都完成后，会重定向到RP指定的回调地址，并且把code和state参数传递过去。比如：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code> HTTP/1.1 302 Found
  Location: https://client.example.org/cb?
    code=SplxlOBeZQQYbYS6WxSbIA
    &amp;state=af0ifjsldkj
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="_3-4-3-获取id-token" tabindex="-1"><a class="header-anchor" href="#_3-4-3-获取id-token" aria-hidden="true">#</a> 3.4.3 获取ID Token</h6><p>RP使用上一步获得的code来请求Token EndPoint，这一步同OAuth2，就不再展开细说了。然后Token EndPoint会返回响应的Token，其中除了OAuth2规定的部分数据外，还会附加一个<strong>id_token</strong>的字段。id_token字段就是上面提到的ID Token。例如：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>HTTP/1.1 200 OK
  Content-Type: application/json
  Cache-Control: no-store
  Pragma: no-cache

  {
   &quot;access_token&quot;: &quot;SlAV32hkKG&quot;,
   &quot;token_type&quot;: &quot;Bearer&quot;,
   &quot;refresh_token&quot;: &quot;8xLOxBtZp8&quot;,
   &quot;expires_in&quot;: 3600,
   &quot;id_token&quot;: &quot;eyJhbGciOiJSUzI1NiIsImtpZCI6IjFlOWdkazcifQ.ewogImlzc
     yI6ICJodHRwOi8vc2VydmVyLmV4YW1wbGUuY29tIiwKICJzdWIiOiAiMjQ4Mjg5
     NzYxMDAxIiwKICJhdWQiOiAiczZCaGRSa3F0MyIsCiAibm9uY2UiOiAibi0wUzZ
     fV3pBMk1qIiwKICJleHAiOiAxMzExMjgxOTcwLAogImlhdCI6IDEzMTEyODA5Nz
     AKfQ.ggW8hZ1EuVLuxNuuIJKX_V8a_OMXzR0EHR9R6jgdqrOOF4daGU96Sr_P6q
     Jp6IcmD3HP99Obi1PRs-cwh3LO-p146waJ8IhehcwL7F09JdijmBqkvPeB2T9CJ
     NqeGpe-gccMg4vfKjkM8FcGvnzZUN4_KSP0aAp1tOJ1zZwgjxqGByKHiOtX7Tpd
     QyHE5lcMiKPXfEIQILVq0pc_E2DzL7emopWoaoZTF_m0_N0YzFC6g6EJbOEoRoS
     K5hoDalrcvRYLSrQAZZKflyuVCyixEoV9GfNQC3_osjzw2PAithfubEEBLuVVk4
     XUVrWOLrLl0nx7RkKU8NXNHq-rvKMzqg&quot;
  }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>其中看起来一堆乱码的部分就是JWT格式的ID Token。在RP拿到这些信息之后，需要对id_token以及access_token进行验证（具体的规则参见http://openid.net/specs/openid-connect-core-1_0.html#IDTokenValidation和http://openid.net/specs/openid-connect-core-1_0.html#ImplicitTokenValidation）。至此，可以说用户身份认证就可以完成了，后续可以根据UserInfo EndPoint获取更完整的信息。</p><h6 id="_3-4-4-implicit-flow和hybrid-flow" tabindex="-1"><a class="header-anchor" href="#_3-4-4-implicit-flow和hybrid-flow" aria-hidden="true">#</a> 3.4.4 Implicit Flow和Hybrid Flow</h6><p>Implicit Flow的工作方式是在OAuth2 Implicit Flow上附加提供id_token，当然，认证请求的参数和基于Authorization Code的流程稍有不同，具体的差异参见http://openid.net/specs/openid-connect-core-1_0.html#ImplicitAuthRequest，这里就不做详细介绍了。</p><p>Hybrid Flow则=Authorization Code Flow+Implicit Flow，也不再详细介绍了。</p><h5 id="_3-5-userinfo-endpoint" tabindex="-1"><a class="header-anchor" href="#_3-5-userinfo-endpoint" aria-hidden="true">#</a> 3.5 UserInfo Endpoint</h5><p>UserIndo EndPoint是一个受OAuth2保护的资源。在RP得到Access Token后可以请求此资源，然后获得一组EU相关的Claims，这些信息可以说是ID Token的扩展，比如如果你觉得ID Token中只需包含EU的唯一标识sub即可（避免ID Token过于庞大），然后通过此接口获取完整的EU的信息。此资源必须部署在TLS之上，例如：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>  GET /userinfo HTTP/1.1
  Host: server.example.com
  Authorization: Bearer SlAV32hkKG
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>成功之后响应如下</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code> HTTP/1.1 200 OK
  Content-Type: application/json

  {
   &quot;sub&quot;: &quot;248289761001&quot;,
   &quot;name&quot;: &quot;Jane Doe&quot;,
   &quot;given_name&quot;: &quot;Jane&quot;,
   &quot;family_name&quot;: &quot;Doe&quot;,
   &quot;preferred_username&quot;: &quot;j.doe&quot;,
   &quot;email&quot;: &quot;janedoe@example.com&quot;,
   &quot;picture&quot;: &quot;http://example.com/janedoe/me.jpg&quot;
  }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>其中sub代表EU的唯一标识，这个claim是必须的，其他的都是可选的。</p><h4 id="_4、总结" tabindex="-1"><a class="header-anchor" href="#_4、总结" aria-hidden="true">#</a> 4、总结</h4><p>继OAuth2之后，感觉OIDC也要大放异彩了。其本身是一个完全开放的标准，而且兼容众多的已有的IDP（身份提供商），比如基于SAML的、基于WS-Federation的等等已有的身份认证系统，都可以作为OIDC的OP存在。总结一下OIDC有那些特性和好处吧：</p><ol><li>OIDC使得身份认证可以作为一个服务存在。</li><li>OIDC可以很方便的实现SSO（跨顶级域）。</li><li>OIDC兼容OAuth2，可以使用Access Token控制受保护的API资源。</li><li>OIDC可以兼容众多的IDP作为OIDC的OP来使用。</li><li>OIDC的一些敏感接口均强制要求TLS，除此之外，得益于JWT,JWS,JWE家族的安全机制，使得一些敏感信息可以进行数字签名、加密和验证，进一步确保整个认证过程中的安全保障</li></ol></div></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="xicon-container left meta-item-label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:20px;height:20px;font-size:20px;color:inherit;"><path d="M26 4h-4V2h-2v2h-8V2h-2v2H6c-1.1 0-2 .9-2 2v20c0 1.1.9 2 2 2h20c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 22H6V12h20v14zm0-16H6V6h4v2h2V6h8v2h2V6h4v4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->Last Updated 1/2/2024, 1:55:41 AM<!--]--></span></span></div></footer><!----><!----></main><!--]--><!----></div></div><!----><!----><!--]--></div>
    <script type="module" src="/assets/app-d26df8f0.js" defer></script>
  </body>
</html>
